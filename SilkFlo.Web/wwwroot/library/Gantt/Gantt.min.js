"use strict";var Gantt2,Gantt;Gantt||(Gantt={});Gantt.MainById=function(n){const t="Gantt.MainById: ";if(!n){console.log(t+"ganttId parameter missing");return}const i=document.getElementById(n);if(!i){console.log(`${t}Element with id ${n} missing`);return}Gantt.Main(i)};Gantt.Main=function(n){if(!n){console.log(`${"Gantt.Main: "}elementTable parameter missing`);return}n.Gantt=new Gantt.Class(n)};Gantt.Class=(class{constructor(n){this.Elements={gantt:null,Dates:[],Table:null,Rows:null,Add:function(n,t,i,r){if(!r)return console.log("Gantt.Class.Elements.Add: container parameter missing"),null;const u=document.createElement(n);return u.setAttribute("gantt-name",t),u.setAttribute("class",i),u.style.userSelect="none",u.Gantt=this.gantt,r.appendChild(u),u},GetRows:function(n){const i=Array.from(n.querySelectorAll(`[name="${this.gantt.Settings.Names.Row}"]`));this.Table.Rows=i;const t=this.Table,r=i.length;for(let n=0;n<r;n++){const r=i[n];r.Table=t;r.RenderProgressBar=function(){if(r.DateCell){const n=r.DateCell.InputStart;if(n){const t=n.value;if(t){const n=Delaney.UI.DatePicker.Moments.GetDate(t);n&&(r.DateStart=n)}}if(r.DateCell.InputEnd){const n=r.DateCell.InputEnd;if(n){const t=n.value;if(t){const n=Delaney.UI.DatePicker.Moments.GetDate(t);n&&(r.DateEnd=n)}}}}const n=r.ChartCell.Bar;n.style.display=r.DateCell.InputStart&&r.DateCell.InputStart.value||r.DateCell.InputEnd&&r.DateCell.InputEnd.value?"":"none";const o=Delaney.UI.DatePicker.Moments.CountCertainDays([1,2,3,4,5],r.DateStart,r.DateEnd),i=Delaney.UI.DatePicker.Moments.GetDays(r.DateStart,r.DateEnd)+1;i===1?(n.classList.remove(Gantt.Settings.Classes.Bar),n.classList.add(Gantt.Settings.Classes.MileStone),n.style.width=""):i>0&&(n.classList.add(Gantt.Settings.Classes.Bar),n.classList.remove(Gantt.Settings.Classes.MileStone),n.style.width=i*Gantt.Settings.DayWidth+Gantt.Settings.Unit);const u=this.Table.Rows.length;if(t.DateStart)for(let n=0;n<u;n++){const i=t.Rows[n];i.DateStart&&t.DateStart.getTime()>i.DateStart.getTime()&&(t.DateStart=i.DateStart)}else t.DateStart=r.DateStart;if(r.DateStart)if(t.DateStart.getTime()>=r.DateStart.getTime()){n.style.marginLeft=0;for(let n=0;n<u;n++){const i=t.Rows[n];if(i!==r&&i.DateStart&&i.DateStart.getTime()>=r.DateStart.getTime()){let n=Delaney.UI.DatePicker.Moments.GetDays(r.DateStart,i.DateStart);i.ChartCell.Bar.style.marginLeft=n*Gantt.Settings.DayWidth+Gantt.Settings.Unit}}}else{let i=r.DateStart;for(let n=0;n<u;n++){const r=t.Rows[n];r.DateStart&&i.getTime()>r.DateStart.getTime()&&(i=r.DateStart)}let f;if(t.DateStart.getTime()!==i.getTime()&&(t.DateStart=i,f=!0),f)for(let n=0;n<u;n++){const i=t.Rows[n];let r=0;t.DateStart.getTime()!==i.DateStart.getTime()&&(r=Delaney.UI.DatePicker.Moments.GetDays(t.DateStart,i.DateStart));i.ChartCell.Bar.style.marginLeft=r*Gantt.Settings.DayWidth+Gantt.Settings.Unit}else{let i=Delaney.UI.DatePicker.Moments.GetDays(t.DateStart,r.DateStart);n.style.marginLeft=i*Gantt.Settings.DayWidth+Gantt.Settings.Unit}}i>2?(n.Text.style.display="block",n.Text.innerHTML=o+" Days"):i===2?(n.Text.style.display="block",n.Text.innerHTML=i):n.Text.style.display="none";let f;r.DateCell&&(f=r.DateCell.InputStart.OldDate);let e;if(r.DateCell&&r.DateCell.InputEnd&&(e=r.DateCell.InputEnd.OldDate),f&&e){const i=Delaney.UI.DatePicker.Moments.CountCertainDays([1,2,3,4,5],f,e);let t=i-o;t===0?n.Badge.style.opacity=0:(n.Badge.style.opacity=1,t>0?(n.Badge.classList.add(Gantt.Settings.Classes.BadgePositive),n.Badge.classList.remove(Gantt.Settings.Classes.BadgeNegative),n.Badge.innerHTML=`<svg style="width: 8px; stroke: white; margin-right: 2px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 6.82 3.85"><path d="M6.69,3.72a.43.43,0,0,1-.63,0L3.41,1.07.76,3.72a.44.44,0,0,1-.63,0,.45.45,0,0,1,0-.63l3-3A.48.48,0,0,1,3.41,0a.44.44,0,0,1,.31.13l3,3A.45.45,0,0,1,6.69,3.72Z"/></svg>${t}`):(n.Badge.classList.remove(Gantt.Settings.Classes.BadgePositive),n.Badge.classList.add(Gantt.Settings.Classes.BadgeNegative),t=t*-1,n.Badge.innerHTML=`<svg style="width: 8px; stroke: white; margin-right: 2px;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 6.82 3.85"><path d="M6.69.13a.45.45,0,0,0-.63,0L3.41,2.78.76.13a.45.45,0,0,0-.63,0,.45.45,0,0,0,0,.63l3,3a.44.44,0,0,0,.32.13.4.4,0,0,0,.31-.13l3-3A.45.45,0,0,0,6.69.13Z"/></svg>${t}`),n.Badge.style.width=t>9||t<-9?"35px":"")}else n.Badge.style.opacity=0}}return i},FormatRows:function(n){const i="Gantt.Class.Elements.FormatRows: ";let t=n.length,r=-1;for(let i=0;i<t;i++){const t=n[i],e=this.FormatTitle(t);e.Row=t;t.TitleCell=e;r++;const s=this.Table.id+"-gantt-date-"+r,u=this.SetUpDatePicker(t,this.gantt.Settings.Names.DateStart,this.gantt.Settings.Names.DateEnd,this.gantt.Settings.Names.DateButton,s);u&&(u.Row=t,t.DateCell=u,this.Dates.push(u));const f=this.Add("td","chart-cell","",t);i===0&&(f.style.position="relative");f.style.width="97%";f.Row=t;t.ChartCell=f;this.AddBar(f);const o=u.InputStart.value;if(o){const n=Delaney.UI.DatePicker.Moments.GetDate(o);this.Table.DateStart?this.Table.DateStart.getTime()>n.getTime()&&(this.Table.DateStart=n):this.Table.DateStart=n;t.RenderProgressBar()}}const u=Array.from(this.Table.querySelectorAll(`[name="gantt-date-cell"]`));t=u.length;for(let n=0;n<t;n++){const t=u[n];if(this.gantt.Settings.IsReadOnly)t.setAttribute("style","display: none; ");else{t.style.display="table-cell";t.style.position="sticky";t.style.zIndex="3";t.style.background="var(--bs-background)";t.style.padding=0;const n=t.children[0];if(!n){console.log(`${i}child missing`);return}n.style.padding="0.5rem";n.style.boxShadow="2px 0 0 var(--border-color), -2px 0 0 var(--border-color)";const r=t.parentElement.TitleCell;if(!r){console.log(`${i}titleCell missing`);return}let u=r.offsetWidth+14;t.style.left=u+"px"}}},FormatTable:function(n){if(!n){console.log(`${"Gantt.Class.Elements.FormatTable: "}tableElement parameter missing`);return}n.setAttribute("class",Gantt.Settings.Classes.Table)},FormatTitle:function(n){const i="Gantt.Class.Elements.FormatTable: ";if(!n)return console.log(`${i}row parameter missing`),null;const t=n.querySelector(`[name="${this.gantt.Settings.Names.Title}"]`);return t?(t.setAttribute("style","width: 1%; vertical-align: middle; position: sticky; left: 0; z-index: 2; background: var(--bs-background); box-shadow: inset -2px 0 0 var(--border-color), inset 0 0 0 9999px var(--bs-table-accent-bg); border-right: none;"),t):(console.log(`${i}element with name ${this.gantt.Settings.Names.Title} missing`),null)},SetUpDatePicker:function(n,t,i,r,u){const o="Gantt.Class.Elements.SetUpDatePicker: ";if(!n)return console.log(`${o}row parameter missing`),null;if(!t)return console.log(`${o}inputStartName parameter missing`),null;if(!i)return console.log(`${o}inputEndName parameter missing`),null;if(!r)return console.log(`${o}buttonName parameter missing`),null;if(!u)return console.log(`${o}id parameter missing`),null;const e=n.querySelector(`[name="${t}"]`);if(!e)return console.log(`${o}Element with name "${t}" missing`),null;const f=n.querySelector(`[name="${i}"]`);e.id=u+"-start";e.style.width="120px";f&&(f.id=u+"-end",f.style.width="120px");e.addEventListener("input",function(){n.RenderProgressBar();n.Table.Gantt.Elements.RenderWeekends(n.Table)});const h=n.querySelector(`[name="${r}"]`);if(!h)return console.log(`${o}Element with name "${r}" missing`),null;f?(Delaney.UI.DatePicker.MainRangeSelector(e,f,h),f.addEventListener("input",function(){n.RenderProgressBar();n.Table.Gantt.Elements.RenderWeekends(n.Table)})):Delaney.UI.DatePicker.Main(e,h);const c="gantt-old-value";if(e.hasAttribute(c)){const n=e.getAttribute(c);if(n){const t=Delaney.UI.DatePicker.Moments.GetDate(n);t&&(e.OldDate=t)}}if(f&&f.hasAttribute(c)){const n=f.getAttribute(c);if(n){const t=Delaney.UI.DatePicker.Moments.GetDate(n);t&&(f.OldDate=t)}}const s=e.parentElement.parentElement;return s.localName!=="td"?(console.log(`${o}parent parent element missing`),null):(s.Button=h,s.InputStart=e,f&&(s.InputEnd=f),s)},AddBar:function(n){if(!n){console.log(`${"Gantt.Class.Elements.AddBar: "}cell parameter missing`);return}const t=this.Add("div","bar","",n),r=Gantt.Settings.AnimationTime/1e3;t.style.transition=`all ${r}s`;const i=this.Add("div","badge","",t),u=this.Add("div","text","",t);i.style.opacity=0;i.style.display="flex";i.style.zIndex=2;i.style.transition=`all ${r}s`;t.Badge=i;u.style.display="none";t.Text=u;t.Text.classList.add(Gantt.Settings.Classes.BarText);n.Bar=t;t.Cell=n},RenderWeekends:function(n){const e="Gantt.Class.Elements.RenderWeekends: ";if(!n){console.log(`${e}tableElement parameter missing`);return}const f=Array.from(n.querySelectorAll(`[name="${this.gantt.Settings.Names.Row}"]`));this.Table.Rows=f;const o=f.length;let i=null,r=null;for(let n=0;n<o;n++){const t=f[n];if(t.DateCell){const n=t.DateCell.InputStart;if(n){const t=n.value;if(t){const n=Delaney.UI.DatePicker.Moments.GetDate(t);let r=!0;n&&i&&i.getTime()<n.getTime()&&(r=!1);r&&(i=n)}}}if(t.DateCell&&t.DateCell.InputEnd){const n=t.DateCell.InputEnd;if(n){const t=n.value;if(t){const n=Delaney.UI.DatePicker.Moments.GetDate(t);let i=!0;n&&r&&r.getTime()>n.getTime()&&(i=!1);i&&(r=n)}}}}if(i&&r&&i.getTime()!==r.getTime()){this.gantt.DateStart=i;const t=f[0];if(!t){console.log(`${e}first row element missing`);return}if(t.children.length!==3){console.log(`${e}chart column missing`);return}const s=t.children[2],h=Delaney.UI.DatePicker.Moments.GetDays(i,r)+1;t.WeekendElements||(t.WeekendElements=[]);let u=0;for(let n=0;n<h;n++){const f=i.AddDays(n),r=f.getDay();if(r===0||r===6){u++;let i=null;t.WeekendElements.length<u?(i=this.Add("div","weekend","",s),i.classList.add("gantt-weekend"),i.setAttribute("style",`width: ${Gantt.Settings.DayWidth}${Gantt.Settings.Unit}; margin-left: 0.5rem; position: absolute;top: 0;height: 300px; transition: all 0.3s ease 0s; z-index: 1;`),t.WeekendElements.push(i)):i=t.WeekendElements[u-1];const r=Gantt.Settings.DayWidth*n+Gantt.Settings.Unit;i.style.left=`${r}`}}if(u<t.WeekendElements.length){const n=t.WeekendElements.length-u;for(let i=0;i<n;i++){const n=t.WeekendElements.pop();n.remove()}}}}};this.Settings={gantt:null,Headings:{Title:null,StartDate:null,EndDate:null},Names:{Row:null,Title:null,DateStart:null,DateEnd:null,DateButton:null},Get:function(){const i="Gantt.Class.Settings.Get: ";if(!this.gantt.Elements.Table){console.log(i+"Table element missing");return}const t=this.gantt.Elements.Table;let n="gantt-setting-row-name";if(!t.hasAttribute(n)){console.log(`${i+n}attribute missing`);return}if(this.Names.Row=t.getAttribute(n),t.removeAttribute(n),n="gantt-setting-title-name",!t.hasAttribute(n)){console.log(`${i+n}attribute missing`);return}if(this.Names.Title=t.getAttribute(n),t.removeAttribute(n),n="gantt-setting-dateStart-name",!t.hasAttribute(n)){console.log(`${i+n}attribute missing`);return}if(this.Names.DateStart=t.getAttribute(n),t.removeAttribute(n),n="gantt-setting-dateButton-name",!t.hasAttribute(n)){console.log(`${i+n} attribute missing`);return}if(this.Names.DateButton=t.getAttribute(n),t.removeAttribute(n),n="gantt-setting-dateEnd-name",!t.hasAttribute(n)){console.log(`${i+n}attribute missing`);return}if(this.Names.DateEnd=t.getAttribute(n),t.removeAttribute(n),n="gantt-setting-title",t.hasAttribute(n)&&(this.Headings.Title=t.getAttribute(n),t.removeAttribute(n)),n="gantt-setting-date-title",t.hasAttribute(n)&&(this.Headings.Date=t.getAttribute(n),t.removeAttribute(n)),this.IsReadOnly=!0,n="gantt-setting-is-read-only",t.hasAttribute(n)){const i=t.getAttribute(n);i.toLowerCase()==="false"&&(this.IsReadOnly=!1);t.removeAttribute(n)}}};this.Main(n)}Main(n){const t="Gantt.Main: ";if(!n){console.log(`${t}elementInput parameter missing`);return}if(n.localName!=="table"){console.log(`${t}Element not an table type`);return}if(this.Elements.gantt=this,this.Elements.Table=n,n.Gantt=this,this.Settings.gantt=this,this.Settings.Get(),this.CheckSettings()){const i=this.Elements.GetRows(n);this.Elements.FormatRows(i);this.Elements.FormatTable(n);this.Elements.RenderWeekends(n)}}UpdateOldDate(n,t,i){const u="Gantt.UpdateOldDate: ";if(!n&&n!==0){console.log(`${u}datePosition parameter missing`);return}const r=this.Elements.Dates[n];if(!t){i?r.InputEnd.OldDate=null:r.InputStart.OldDate=null;return}if(!Number.isInteger(n)){console.log(`${u}datePosition not integer`);return}if(n>this.Elements.Dates.length||n<0){console.log(`${u}datePosition outside range`);return}const f=Delaney.UI.DatePicker.Moments.GetDate(t);if(!f){console.log(u+t+" does not produce a date");return}i?r.InputEnd.OldDate=f:r.InputStart.OldDate=f;r.Row.RenderProgressBar()}CheckSettings(){const n="Gantt.CheckSettings: ";return Gantt.Settings?Gantt.Settings.Classes?Gantt.Settings.Classes.Title?Gantt.Settings.Classes.Table?Gantt.Settings.Classes.Bar?Gantt.Settings.Classes.MileStone?Gantt.Settings.Classes.BadgePositive?Gantt.Settings.Classes.BadgeNegative?Gantt.Settings.Classes.BarText?this.Settings.Names?this.Settings.Names.Row?this.Settings.Names.Title?this.Settings.Names.DateStart?this.Settings.Names.DateEnd?this.Settings.Names.DateButton?Gantt.Settings.DayWidth?Gantt.Settings.Unit?Gantt.Settings.AnimationTime?!0:(console.log(`${n}Gantt.Settings.AnimationTime property missing`),!1):(console.log(`${n}Gantt.Settings.Unit property missing`),!1):(console.log(`${n}Gantt.Settings.DayWidth property missing`),!1):(console.log(`${n}Settings.Names.DateButton property missing`),!1):(console.log(`${n}Settings.Names.DateEnd property missing`),!1):(console.log(`${n}Settings.Names.DateStart property missing`),!1):(console.log(`${n}Settings.Names.Title property missing`),!1):(console.log(`${n}Settings.Names.Row property missing`),!1):(console.log(`${n}Settings.Names property missing`),!1):(console.log(`${n}Gantt.Settings.Classes.BarText property missing`),!1):(console.log(`${n}Gantt.Settings.Classes.BadgeNegative property missing`),!1):(console.log(`${n}Gantt.Settings.Classes.BadgePositive property missing`),!1):(console.log(`${n}Gantt.Settings.Classes.MileStone property missing`),!1):(console.log(`${n}Gantt.Settings.Classes.Bar property missing`),!1):(console.log(`${n}Gantt.Settings.Classes.Table property missing`),!1):(console.log(`${n}Gantt.Settings.Classes.Title property missing`),!1):(console.log(`${n}Gantt.Settings.Classes property missing`),!1):(console.log(`${n}Gantt.Settings property missing`),!1)}});Gantt2||(Gantt2={});Gantt2.UpdateOldDate=function(n,t,i,r){const u="Gantt2.UpdateOldDate: ";if(!n){console.log(`${u}targetTableId parameter missing`);return}const f=document.getElementById(n);if(!f){console.log(`${u}Element with id "gantt2" missing`);return}if(!f.Gantt){console.log(`${u}Gantt object missing`);return}f.Gantt.UpdateOldDate(t,i,r)};Gantt||(Gantt={});Gantt.Settings={Classes:{Title:"gantt-title",Table:"table table-striped",Bar:"gantt-bar",MileStone:"gantt-mileStone",BadgePositive:"gantt-badge-positive",BadgeNegative:"gantt-badge-negative",BarText:"gantt-bar-text",Weekend:"gantt-weekend"},DayWidth:25,Unit:"px",AnimationTime:300};